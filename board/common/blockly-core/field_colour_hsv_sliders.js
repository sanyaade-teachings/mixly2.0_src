/*! For license information please see index.js.LICENSE.txt */
!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("blockly/core"));else if("function"==typeof define&&define.amd)define(["blockly/core"],t);else{var r="object"==typeof exports?t(require("blockly/core")):t(e.Blockly);for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(this,(e=>(()=>{"use strict";var t={573:t=>{t.exports=e}},r={};function n(e){var o=r[e];if(void 0!==o)return o.exports;var i=r[e]={exports:{}};return t[e](i,i.exports,n),i.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};return(()=>{n.r(o),n.d(o,{FieldColourHsvSliders:()=>S});var e=n(573);function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function r(e,t){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},r(e,t)}function i(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return a(e)}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}function s(e,t,r){return(t=p(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p(n.key),n)}}function c(e,t,r){return t&&h(e.prototype,t),r&&h(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function p(e){var t=function(e,t){if("object"!==u(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===u(t)?t:String(t)}var f,b=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;d(this,e),this.r=t,this.g=r,this.b=n}return c(e,[{key:"toHex",value:function(){return"#"+e.componentToHex(this.r)+e.componentToHex(this.g)+e.componentToHex(this.b)}},{key:"loadFromHex",value:function(e){return this.r=parseInt(e.slice(1,3),16)/255,this.g=parseInt(e.slice(3,5),16)/255,this.b=parseInt(e.slice(5,7),16)/255,this}},{key:"loadFromHsv",value:function(e){var t=6*(e.h-Math.floor(e.h));return this.r=e.v*(1-e.s*Math.max(0,Math.min(1,2-Math.abs(t-3)))),this.g=e.v*(1-e.s*Math.max(0,Math.min(1,Math.abs(t-2)-1))),this.b=e.v*(1-e.s*Math.max(0,Math.min(1,Math.abs(t-4)-1))),this}}],[{key:"componentToHex",value:function(e){return e<=0?"00":e>=1?"ff":("0"+(255*e+.5>>>0).toString(16)).slice(-2)}}]),e}(),v=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;d(this,e),this.h=t,this.s=r,this.v=n}return c(e,[{key:"loadFromRgb",value:function(e){var t=Math.max(Math.max(e.r,e.g),e.b),r=Math.min(Math.min(e.r,e.g),e.b);if(this.v=t,r==t)return this.h=0,this.s=0,this;var n,o=t-r;return this.s=o/t,n=e.r==t?(e.g-e.b)/o:e.g==t?2+(e.b-e.r)/o:4+(e.r-e.g)/o,n/=6,this.h=n-Math.floor(n),this}},{key:"copy",value:function(e){return this.h=e.h,this.s=e.s,this.v=e.v,this}}]),e}(),S=function(n){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r(e,t)}(p,n);var o,u,h=(o=p,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=l(o);if(u){var r=l(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return i(this,e)});function p(){var e;d(this,p);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return s(a(e=h.call.apply(h,[this].concat(r))),"boundEvents",[]),s(a(e),"hueReadout",null),s(a(e),"hueSlider",null),s(a(e),"saturationReadout",null),s(a(e),"saturationSlider",null),s(a(e),"brightnessReadout",null),s(a(e),"brightnessSlider",null),s(a(e),"dropdownContainer",null),e}return c(p,[{key:"showEditor_",value:function(){if(this.createDropdownSliders(),!this.dropdownContainer||!this.hueSlider)throw new Error("Failed to initialize the HSV sliders.");e.DropDownDiv.getContentDiv().appendChild(this.dropdownContainer),e.DropDownDiv.showPositionedByField(this,this.dropdownDisposeSliders.bind(this)),this.hueSlider.focus({preventScroll:!0})}},{key:"createDropdownSliders",value:function(){var t=document.createElement("div");if(t.classList.add("fieldColourSliderContainer"),this.hueReadout=p.createLabelInContainer(e.Msg.HUE,t),this.hueSlider=p.createSliderInContainer(p.HUE_SLIDER_MAX,2,t),this.saturationReadout=p.createLabelInContainer(e.Msg.SATURATION,t),this.saturationSlider=p.createSliderInContainer(p.SATURATION_SLIDER_MAX,1,t),this.brightnessReadout=p.createLabelInContainer(e.Msg.BRIGHTNESS,t),this.brightnessSlider=p.createSliderInContainer(p.BRIGHTNESS_SLIDER_MAX,1,t),this.boundEvents.push(e.browserEvents.conditionalBind(this.hueSlider,"input",this,this.onSliderChange)),this.boundEvents.push(e.browserEvents.conditionalBind(this.saturationSlider,"input",this,this.onSliderChange)),this.boundEvents.push(e.browserEvents.conditionalBind(this.brightnessSlider,"input",this,this.onSliderChange)),window.EyeDropper){var r=document.createElement("button");r.classList.add("fieldColourEyedropper"),t.appendChild(document.createElement("hr")),t.appendChild(r),this.boundEvents.push(e.browserEvents.conditionalBind(r,"click",this,this.onEyedropperEvent))}this.dropdownContainer=t,this.updateSliderValues()}},{key:"dropdownDisposeSliders",value:function(){var r,n=function(e,r){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,r){if(e){if("string"==typeof e)return t(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?t(e,r):void 0}}(e))||r&&e&&"number"==typeof e.length){n&&(e=n);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,l=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){s=!0,a=e},f:function(){try{l||null==n.return||n.return()}finally{if(s)throw a}}}}(this.boundEvents);try{for(n.s();!(r=n.n()).done;){var o=r.value;e.browserEvents.unbind(o)}}catch(e){n.e(e)}finally{n.f()}this.boundEvents.length=0,this.hueReadout=null,this.hueSlider=null,this.saturationReadout=null,this.saturationSlider=null,this.brightnessReadout=null,this.brightnessSlider=null,this.dropdownContainer=null}},{key:"onSliderChange",value:function(e){if(!this.hueSlider||!this.saturationSlider||!this.brightnessSlider)throw new Error("The HSV sliders are missing.");var t=parseFloat(this.hueSlider.value)/p.HUE_SLIDER_MAX,r=parseFloat(this.saturationSlider.value)/p.SATURATION_SLIDER_MAX,n=parseFloat(this.brightnessSlider.value)/p.BRIGHTNESS_SLIDER_MAX;this.setValue(p.hsvToHex(t,r,n)),this.renderSliders()}},{key:"onEyedropperEvent",value:function(e){var t=this;window.EyeDropper&&(new window.EyeDropper).open().then((function(e){t.setValue(e.sRGBHex),t.updateSliderValues()}))}},{key:"renderSliders",value:function(){if(!(this.hueSlider&&this.hueReadout&&this.saturationSlider&&this.saturationReadout&&this.brightnessSlider&&this.brightnessReadout))throw new Error("The HSV sliders are missing.");this.hueReadout.textContent=this.hueSlider.value,this.saturationReadout.textContent=this.saturationSlider.value,this.brightnessReadout.textContent=this.brightnessSlider.value;var e=parseFloat(this.hueSlider.value)/p.HUE_SLIDER_MAX,t=parseFloat(this.saturationSlider.value)/p.SATURATION_SLIDER_MAX,r=parseFloat(this.brightnessSlider.value)/p.BRIGHTNESS_SLIDER_MAX,n="linear-gradient(to right, ";n+=p.hsvToHex(0,t,r)+" ".concat(p.THUMB_RADIUS,"px, "),n+=p.hsvToHex(1/6,t,r)+", ",n+=p.hsvToHex(2/6,t,r)+", ",n+=p.hsvToHex(.5,t,r)+", ",n+=p.hsvToHex(4/6,t,r)+", ",n+=p.hsvToHex(5/6,t,r)+", ",n+=p.hsvToHex(1,t,r)+" calc(100% - ".concat(p.THUMB_RADIUS,"px))"),this.hueSlider.style.setProperty("--slider-track-background",n);var o="linear-gradient(to right, ";o+=p.hsvToHex(e,0,r)+" ".concat(p.THUMB_RADIUS,"px, "),o+=p.hsvToHex(e,1,r)+" calc(100% - ".concat(p.THUMB_RADIUS,"px))"),this.saturationSlider.style.setProperty("--slider-track-background",o);var i="linear-gradient(to right, ";i+=p.hsvToHex(e,t,0)+" ".concat(p.THUMB_RADIUS,"px, "),i+=p.hsvToHex(e,t,1)+" calc(100% - ".concat(p.THUMB_RADIUS,"px))"),this.brightnessSlider.style.setProperty("--slider-track-background",i)}},{key:"updateSliderValues",value:function(){if(this.hueSlider&&this.saturationSlider&&this.brightnessSlider){var e=p.helperHsv.loadFromRgb(p.helperRgb.loadFromHex(this.getValue()));this.hueSlider.value=String(e.h*p.HUE_SLIDER_MAX),this.saturationSlider.value=String(e.s*p.SATURATION_SLIDER_MAX),this.brightnessSlider.value=String(e.v*p.BRIGHTNESS_SLIDER_MAX),this.renderSliders()}}}],[{key:"createLabelInContainer",value:function(e,t){var r=document.createElement("div"),n=document.createElement("span"),o=document.createElement("span");return r.classList.add("fieldColourSliderLabel"),n.textContent=e,r.appendChild(n),r.appendChild(o),t.appendChild(r),o}},{key:"createSliderInContainer",value:function(e,t,r){var n=document.createElement("input");return n.classList.add("fieldColourSlider"),n.type="range",n.min=String(0),n.max=String(e),n.step=String(t),r.appendChild(n),n}},{key:"hsvToHex",value:function(e,t,r){return p.helperHsv.h=e,p.helperHsv.s=t,p.helperHsv.v=r,p.helperRgb.loadFromHsv(p.helperHsv).toHex()}}]),p}(e.FieldColour);s(S,"HUE_SLIDER_MAX",360),s(S,"SATURATION_SLIDER_MAX",100),s(S,"BRIGHTNESS_SLIDER_MAX",100),s(S,"THUMB_RADIUS",12),s(S,"helperHsv",new v),s(S,"helperRgb",new b),f=e,Object.defineProperty(f,"FieldColourHsvSliders",{value:S,writable:!0,enumerable:!0,configurable:!0}),e.fieldRegistry.register("field_colour_hsv_sliders",e.FieldColourHsvSliders),e.Css.register(['\n  .fieldColourSliderContainer {\n    padding: 4px;\n  }\n  .fieldColourSliderContainer hr {\n    border: none;\n    border-top: 1px solid #bbb;\n  }\n  .fieldColourSliderLabel {\n    display: flex;\n    justify-content: space-between;\n    color: #5c5c5c;\n  }\n  .fieldColourEyedropper {\n    appearance: none;\n    position: relative;\n    border: none;\n    border-radius: 4px;\n    background: transparent;\n    font: inherit;\n    color: inherit;\n    cursor: pointer;\n    width: 100%;\n    margin: 0;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    color: #5c5c5c;\n  }\n  .fieldColourEyedropper:hover {\n    background: rgba(0,0,0,0.1)\n  }\n  .fieldColourEyedropper input {\n    opacity: 0;\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n  }\n  .fieldColourEyedropper::before {\n    content: "'.concat(e.Msg.EYEDROPPER,'";\n  }\n  .fieldColourEyedropper::after {\n    content: "";\n    margin-left: 8px;\n    width: 24px;\n    height: 24px;\n    background: currentColor;\n    pointer-events: none;\n    -webkit-mask-image: var(--customize-dial-symbol);\n    -webkit-mask-repeat: no-repeat;\n    -webkit-mask-position: center;\n    mask-image: var(--customize-dial-symbol);\n    mask-repeat: no-repeat;\n    mask-position: center;\n    --customize-dial-symbol: url(\'data:image/svg+xml,      <svg xmlns="http://www.w3.org/2000/svg"            width="24px" height="24px"            viewBox="0 0 24 24">         <path stroke="black" strokewidth="1.414" fill="none"               d="m 13 8 L 6 15 Q 3 18 2 21 Q 0 23 .5 23.5 Q 1 24 3 22                   Q 6 21 9 18 L 16 11"/>         <path fill="black"               d="m 12 7 Q 11 6 12 5 Q 13 4 14 5 Q 15 6 16 5 Q 20 -1 22.5 1.5                   Q 25 4 19 8 Q 18 9 19 10 Q 20 11 19 12 Q 18 13 17 12"/>       </svg>\');\n  }\n  .fieldColourSlider {\n    -webkit-appearance: none;\n    width: 150px;\n    height: 24px;\n    margin: 4px 8px 24px 8px;\n    padding: 0;\n  }\n  .fieldColourSlider:last-child {\n    margin-bottom: 4px;\n  }\n  .fieldColourSlider:focus {\n    outline: none;\n  }\n  /* Webkit */\n  .fieldColourSlider::-webkit-slider-runnable-track {\n    background: var(--slider-track-background);\n    border-radius: 8px;\n    height: 16px;\n  }\n  .fieldColourSlider::-webkit-slider-thumb {\n    -webkit-appearance: none;\n    background: #fff;\n    border-radius: 50%;\n    box-shadow: 0 0 0 4px rgba(0,0,0,.15);\n    cursor: pointer;\n    width: ').concat(2*S.THUMB_RADIUS,"px;\n    height: ").concat(2*S.THUMB_RADIUS,"px;\n    margin-top: -4px;\n  }\n  /* Firefox */\n  .fieldColourSlider::-moz-range-track {\n    background: var(--slider-track-background);\n    border-radius: 8px;\n    height: 16px;\n  }\n  .fieldColourSlider::-moz-range-thumb {\n    background: #fff;\n    border: none;\n    border-radius: 50%;\n    box-shadow: 0 0 0 4px rgba(0,0,0,.15);\n    cursor: pointer;\n    width: ").concat(2*S.THUMB_RADIUS,"px;\n    height: ").concat(2*S.THUMB_RADIUS,"px;\n  }\n  .fieldColourSlider::-moz-focus-outer {\n    /* override the focus border style */\n    border: 0;\n  }\n  /* IE */\n  .fieldColourSlider::-ms-track {\n    background: var(--slider-track-background);\n    border-radius: 12px;\n    width: 100%;\n    height: 24px;\n    /* remove default tick marks */\n    color: transparent;\n  }\n  .fieldColourSlider::-ms-fill-lower  {\n    background: transparent;\n  }\n  .fieldColourSlider::-ms-fill-upper  {\n    background: transparent;\n  }\n  .fieldColourSlider::-ms-thumb {\n    background: #fff;\n    border: none;\n    border-radius: 50%;\n    box-shadow: 0 0 0 4px rgba(0,0,0,.15);\n    cursor: pointer;\n    width: ").concat(2*S.THUMB_RADIUS,"px;\n    height: ").concat(2*S.THUMB_RADIUS,"px;\n  }\n")])})(),o})()));