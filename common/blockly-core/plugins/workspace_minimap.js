/*! For license information please see index.js.LICENSE.txt */
!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e(require("blockly/core"));else if("function"==typeof define&&define.amd)define(["blockly/core"],e);else{var i="object"==typeof exports?e(require("blockly/core")):e(t.Blockly);for(var o in i)("object"==typeof exports?exports:t)[o]=i[o]}}(this,(t=>(()=>{"use strict";var e={224:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.FocusRegion=void 0;var o=i(573),s=new Set([o.Events.VIEWPORT_CHANGE,o.Events.BLOCK_CHANGE,o.Events.BLOCK_CREATE,o.Events.BLOCK_DELETE,o.Events.BLOCK_DRAG,o.Events.BLOCK_MOVE]),n=function(){function t(t,e){this.primaryWorkspace=t,this.minimapWorkspace=e,this.initialized=!1,this.id=String(Math.random()).substring(2)}return t.prototype.init=function(){var t=this;this.svgGroup=o.utils.dom.createSvgElement(o.utils.Svg.G,{class:"blockly-focus-region"},null);var e=o.utils.dom.createSvgElement(new o.utils.Svg("mask"),{id:"focusRegionMask"+this.id},this.svgGroup);this.background=o.utils.dom.createSvgElement(o.utils.Svg.RECT,{x:0,y:0,width:"100%",height:"100%",mask:"url(#focusRegionMask"+this.id+")"},this.svgGroup),o.utils.dom.createSvgElement(o.utils.Svg.RECT,{x:0,y:0,width:"100%",height:"100%",fill:"white"},e),this.rect=o.utils.dom.createSvgElement(o.utils.Svg.RECT,{x:0,y:0,rx:6,ry:6,fill:"black"},e);var i=this.minimapWorkspace.getParentSvg();i.firstChild?i.insertBefore(this.svgGroup,i.firstChild):i.appendChild(this.svgGroup),window.addEventListener("resize",(function(){t.update()})),this.onChangeWrapper=this.onChange.bind(this),this.primaryWorkspace.addChangeListener(this.onChangeWrapper),this.update(),this.initialized=!0},t.prototype.dispose=function(){this.onChangeWrapper&&(this.primaryWorkspace.removeChangeListener(this.onChangeWrapper),this.onChangeWrapper=null),this.svgGroup&&o.utils.dom.removeNode(this.svgGroup),this.svgGroup=null,this.rect=null,this.background=null,this.initialized=!1},t.prototype.onChange=function(t){s.has(t.type)&&this.minimapWorkspace.getTopBlocks(!1).length&&this.update()},t.prototype.update=function(){var t=this.primaryWorkspace.getMetricsManager(),e=this.minimapWorkspace.getMetricsManager(),i=t.getViewMetrics(!0),o=t.getContentMetrics(!0),s=e.getContentMetrics(),n=e.getSvgMetrics();if(0===o.width)return this.rect.setAttribute("width",i.width.toString()),void this.rect.setAttribute("height",i.height.toString());var r=s.width/e.getContentMetrics(!0).width,a=i.width*r,p=i.height*r,h=(i.left-o.left)*r,c=(i.top-o.top)*r;h+=(n.width-s.width)/2,c+=(n.height-s.height)/2,this.rect.setAttribute("transform","translate(".concat(h,",").concat(c,")")),this.rect.setAttribute("width",a.toString()),this.rect.setAttribute("height",p.toString())},t.prototype.isEnabled=function(){return this.initialized},t}();e.FocusRegion=n,o.Css.register("\n.dark-theme .blockly-focus-region {\n  fill: #171515;\n}\n\n.blockly-focus-region {\n  fill: #e6e6e6;\n}\n")},351:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Minimap=void 0;var o=i(573),s=i(224),n=new Set([o.Events.BLOCK_CHANGE,o.Events.BLOCK_CREATE,o.Events.BLOCK_DELETE,o.Events.BLOCK_DRAG,o.Events.BLOCK_MOVE]),r=function(){function t(t){this.primaryWorkspace=t,this.closed=!1,this.btn=null}return t.prototype.init=function(){var t=this;this.minimapWrapper=document.createElement("div"),this.minimapWrapper.id="minimapWrapper"+this.primaryWorkspace.id,this.minimapWrapper.className="blockly-minimap";var e=document.createElement("div");e.setAttribute("style","\n        display: flex;\n        align-items: center;\n        justify-content: flex-end;\n        padding: 3px;\n        "),this.btn=document.createElement("button"),this.btn.innerHTML=o.Msg.MINIMAP_CLOSE,this.btn.className="layui-btn self-adaption-btn layui-btn-xs",e.appendChild(this.btn);var i=this.primaryWorkspace.getInjectionDiv().parentNode;i.appendChild(this.minimapWrapper);var n=this.primaryWorkspace.getRenderer().getClassName();n=n.split("-")[0],this.minimapWorkspace=o.inject(this.minimapWrapper.id,{rtl:this.primaryWorkspace.RTL,move:{scrollbars:!0,drag:!1,wheel:!1},zoom:{maxScale:null,minScale:null},readOnly:!0,renderer:n,theme:this.primaryWorkspace.getTheme()}),this.minimapWrapper.appendChild(e),this.minimapWorkspace.scrollbar.setContainerVisible(!1),this.primaryWorkspace.addChangeListener((function(e){t.mirror(e)})),o.browserEvents.bind(this.btn,"click",this,this.changeStatus),window.addEventListener("resize",(function(){t.minimapWorkspace.zoomToFit()})),this.onMouseDownWrapper=o.browserEvents.bind(this.minimapWorkspace.svgGroup_,"mousedown",this,this.onClickDown),this.onMouseUpWrapper=o.browserEvents.bind(i,"mouseup",this,this.onClickUp),this.focusRegion=new s.FocusRegion(this.primaryWorkspace,this.minimapWorkspace),this.enableFocusRegion()},t.prototype.changeStatus=function(){this.closed=!this.closed,this.closed?this.btn.innerHTML=o.Msg.MINIMAP_OPEN:this.btn.innerHTML=o.Msg.MINIMAP_CLOSE},t.prototype.dispose=function(){this.isFocusEnabled()&&this.disableFocusRegion(),this.minimapWorkspace.dispose(),o.utils.dom.removeNode(this.minimapWrapper),this.onMouseMoveWrapper&&o.browserEvents.unbind(this.onMouseMoveWrapper),this.onMouseDownWrapper&&o.browserEvents.unbind(this.onMouseDownWrapper),this.onMouseUpWrapper&&o.browserEvents.unbind(this.onMouseUpWrapper)},t.prototype.mirror=function(t){var e=this;if(n.has(t.type)&&(t.type!==o.Events.BLOCK_CREATE||"shadow"!==t.xml.tagName)){var i=t.toJson();o.Events.fromJson(i,this.minimapWorkspace).run(!0),o.renderManagement.finishQueuedRenders().then((function(){e.minimapWorkspace.zoomToFit()}))}},t.minimapToPrimaryCoords=function(t,e,i,o){i-=(e.svgWidth-e.contentWidth)/2,o-=(e.svgHeight-e.contentHeight)/2;var s=t.contentWidth/e.contentWidth;i*=s,o*=s;var n=-t.contentLeft-i,r=-t.contentTop-o;return[n+=t.viewWidth/2,r+=t.viewHeight/2]},t.prototype.primaryScroll=function(e){var i=t.minimapToPrimaryCoords(this.primaryWorkspace.getMetrics(),this.minimapWorkspace.getMetrics(),e.offsetX,e.offsetY),o=i[0],s=i[1];this.primaryWorkspace.scroll(o,s)},t.prototype.onClickDown=function(t){this.minimapWorkspace.getTopBlocks(!1).length&&(this.onMouseMoveWrapper=o.browserEvents.bind(this.minimapWorkspace.svgGroup_,"mousemove",this,this.onMouseMove),this.primaryScroll(t))},t.prototype.onClickUp=function(){this.onMouseMoveWrapper&&(o.browserEvents.unbind(this.onMouseMoveWrapper),this.onMouseMoveWrapper=null)},t.prototype.onMouseMove=function(t){this.primaryScroll(t)},t.prototype.enableFocusRegion=function(){this.focusRegion.init()},t.prototype.disableFocusRegion=function(){this.focusRegion.dispose()},t.prototype.isFocusEnabled=function(){return this.focusRegion.isEnabled()},t}();e.Minimap=r},153:function(t,e,i){var o,s=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.PositionedMinimap=void 0;var n=i(573),r=function(t){function e(e){var i=t.call(this,e)||this;return i.id="minimap",i.margin=20,i.top=0,i.left=0,i.width=225,i.height=180,i.shadowColor="grey",i.bgColor="#fff",i}return s(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.primaryWorkspace.getComponentManager().addComponent({component:this,weight:3,capabilities:[n.ComponentManager.Capability.POSITIONABLE]}),this.setAttributes(),this.primaryWorkspace.resize()},e.prototype.changeStatus=function(){t.prototype.changeStatus.call(this),this.closed?this.height=30:this.height=180,this.setAttributes(),this.primaryWorkspace.resize(),!this.closed&&this.minimapWorkspace.zoomToFit()},e.prototype.getBoundingRectangle=function(){return new n.utils.Rect(this.top,this.top+this.height,this.left,this.left+this.width)},e.prototype.position=function(t,e){this.setSize(),this.setPosition(t,e),this.setAttributes()},e.prototype.setSize=function(){var t=this.primaryWorkspace.getMetrics().viewWidth;this.width=Math.max(200,t/5),this.height=2*this.width/3},e.prototype.setPosition=function(t,e){var i=this.primaryWorkspace,o=i.scrollbar,s=o&&o.isVisible()&&o.canScrollVertically(),r=o&&o.isVisible()&&o.canScrollHorizontally();t.toolboxMetrics.position===n.TOOLBOX_AT_LEFT||i.horizontalLayout&&!i.RTL?(this.left=t.absoluteMetrics.left+t.viewMetrics.width-this.width-this.margin,s&&!i.RTL&&(this.left-=n.Scrollbar.scrollbarThickness)):(this.left=this.margin,s&&i.RTL&&(this.left+=n.Scrollbar.scrollbarThickness));var a=t.toolboxMetrics.position===n.TOOLBOX_AT_BOTTOM;e[0].top<0&&(a=!0),a?(this.top=t.absoluteMetrics.top+t.viewMetrics.height-this.height-this.margin,r&&(this.top-=n.Scrollbar.scrollbarThickness)):this.top=t.absoluteMetrics.top+this.margin;for(var p=this.getBoundingRectangle(),h=0;h<e.length;h++)p.intersects(e[h])&&(this.top=e[h].top-this.height-this.margin,p=this.getBoundingRectangle(),h=-1);"dark-theme"===this.primaryWorkspace.getTheme().getClassName()?(this.shadowColor="black",this.bgColor="#1e1e1e"):(this.shadowColor="grey",this.bgColor="#fff")},e.prototype.setAttributes=function(){var t=this.minimapWorkspace.getInjectionDiv();this.closed?t.setAttribute("style","display: none;"):t.setAttribute("style","display: block;box-shadow: 2px 2px 10px ".concat(this.shadowColor,";")),t.parentElement.setAttribute("style","z-index: 2;\n          position: absolute;\n          width: ".concat(this.width,"px;\n          height: ").concat(this.height,"px;\n          top: ").concat(this.top,"px;\n          left: ").concat(this.left,"px;\n          display: inline-flex;\n          flex-direction: column;")),n.svgResize(this.minimapWorkspace)},e}(i(351).Minimap);e.PositionedMinimap=r},573:e=>{e.exports=t}},i={};function o(t){var s=i[t];if(void 0!==s)return s.exports;var n=i[t]={exports:{}};return e[t].call(n.exports,n,n.exports,o),n.exports}var s={};return(()=>{var t=s;Object.defineProperty(t,"__esModule",{value:!0}),t.PositionedMinimap=t.Minimap=void 0;var e=o(351);Object.defineProperty(t,"Minimap",{enumerable:!0,get:function(){return e.Minimap}});var i=o(153);Object.defineProperty(t,"PositionedMinimap",{enumerable:!0,get:function(){return i.PositionedMinimap}})})(),s})()));