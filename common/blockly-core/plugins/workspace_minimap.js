/*! For license information please see index.js.LICENSE.txt */
!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e(require("blockly/core"));else if("function"==typeof define&&define.amd)define(["blockly/core"],e);else{var i="object"==typeof exports?e(require("blockly/core")):e(t.Blockly);for(var o in i)("object"==typeof exports?exports:t)[o]=i[o]}}(this,(t=>(()=>{"use strict";var e={351:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Minimap=void 0;var o=i(573),n=new Set([o.Events.BLOCK_CHANGE,o.Events.BLOCK_CREATE,o.Events.BLOCK_DELETE,o.Events.BLOCK_DRAG,o.Events.BLOCK_MOVE]),r=function(){function t(t){this.primaryWorkspace=t,this.closed=!1,this.btn=null}return t.prototype.init=function(){var t=this,e=document.createElement("div");e.id="minimapWrapper_"+this.primaryWorkspace.id,e.className="minimapWrapper";var i=document.createElement("div");i.setAttribute("style","\n        display: flex;\n        align-items: center;\n        justify-content: flex-end;\n        padding: 3px;\n        "),this.btn=document.createElement("button"),this.btn.innerHTML=o.Msg.MINIMAP_CLOSE,this.btn.className="layui-btn self-adaption-btn layui-btn-xs",i.appendChild(this.btn);var n=this.primaryWorkspace.getInjectionDiv().parentNode;n.appendChild(e);var r=this.primaryWorkspace.getRenderer().getClassName();r=r.split("-")[0],this.minimapWorkspace=o.inject(e.id,{rtl:this.primaryWorkspace.RTL,move:{scrollbars:!0,drag:!1,wheel:!1},zoom:{maxScale:null,minScale:null},readOnly:!0,renderer:r}),e.appendChild(i),this.minimapWorkspace.setTheme(this.primaryWorkspace.getTheme()),this.minimapWorkspace.scrollbar.setContainerVisible(!1),this.primaryWorkspace.addChangeListener((function(e){t.mirror(e)})),o.browserEvents.bind(this.btn,"click",this,this.changeStatus),o.browserEvents.bind(this.minimapWorkspace.svgGroup_,"mousedown",this,this.onClickDown),o.browserEvents.bind(n,"mouseup",this,this.onClickUp)},t.prototype.changeStatus=function(){this.closed=!this.closed,this.closed?this.btn.innerHTML=o.Msg.MINIMAP_OPEN:this.btn.innerHTML=o.Msg.MINIMAP_CLOSE},t.prototype.mirror=function(t){var e=this;if(n.has(t.type)){var i=t.toJson();o.Events.fromJson(i,this.minimapWorkspace).run(!0),o.renderManagement.finishQueuedRenders().then((function(){e.minimapWorkspace.zoomToFit()}))}},t.minimapToPrimaryCoords=function(t,e,i,o){i-=(e.svgWidth-e.contentWidth)/2,o-=(e.svgHeight-e.contentHeight)/2;var n=t.contentWidth/e.contentWidth;i*=n,o*=n;var r=-t.contentLeft-i,s=-t.contentTop-o;return[r+=t.viewWidth/2,s+=t.viewHeight/2]},t.prototype.primaryScroll=function(e){var i=t.minimapToPrimaryCoords(this.primaryWorkspace.getMetrics(),this.minimapWorkspace.getMetrics(),e.offsetX,e.offsetY),o=i[0],n=i[1];this.primaryWorkspace.scroll(o,n)},t.prototype.onClickDown=function(t){this.minimapWorkspace.getTopBlocks(!1).length&&(this.onMouseMoveWrapper=o.browserEvents.bind(this.minimapWorkspace.svgGroup_,"mousemove",this,this.onMouseMove),this.primaryScroll(t))},t.prototype.onClickUp=function(){this.onMouseMoveWrapper&&this.onMouseMoveWrapper.length&&o.browserEvents.unbind(this.onMouseMoveWrapper)},t.prototype.onMouseMove=function(t){this.primaryScroll(t)},t}();e.Minimap=r},153:function(t,e,i){var o,n=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.PositionedMinimap=void 0;var r=i(573),s=function(t){function e(e){var i=t.call(this,e)||this;return i.id="minimap",i.margin=20,i.top=0,i.left=0,i.width=225,i.height=180,i.shadowColor="grey",i.bgColor="#fff",i}return n(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.primaryWorkspace.getComponentManager().addComponent({component:this,weight:3,capabilities:[r.ComponentManager.Capability.POSITIONABLE]}),this.primaryWorkspace.resize()},e.prototype.changeStatus=function(){t.prototype.changeStatus.call(this),this.closed?this.height=30:this.height=180,this.setMinimapCss(),this.primaryWorkspace.resize(),!this.closed&&this.minimapWorkspace.zoomToFit()},e.prototype.getBoundingRectangle=function(){return new r.utils.Rect(this.top,this.top+this.height,this.left,this.left+this.width)},e.prototype.position=function(t,e){var i=this.primaryWorkspace,o=i.scrollbar,n=o&&o.isVisible()&&o.canScrollVertically(),s=o&&o.isVisible()&&o.canScrollHorizontally();t.toolboxMetrics.position===r.TOOLBOX_AT_LEFT||i.horizontalLayout&&!i.RTL?(this.left=t.absoluteMetrics.left+t.viewMetrics.width-this.width-this.margin,n&&!i.RTL&&(this.left-=r.Scrollbar.scrollbarThickness)):(this.left=this.margin,n&&i.RTL&&(this.left+=r.Scrollbar.scrollbarThickness));var a=t.toolboxMetrics.position===r.TOOLBOX_AT_BOTTOM;e[0].top<0&&(a=!0),a?(this.top=t.absoluteMetrics.top+t.viewMetrics.height-this.height-this.margin,s&&(this.top-=r.Scrollbar.scrollbarThickness)):this.top=t.absoluteMetrics.top+this.margin;for(var p=this.getBoundingRectangle(),c=0;c<e.length;c++)p.intersects(e[c])&&(this.top=e[c].top-this.height-this.margin,p=this.getBoundingRectangle(),c=-1);"dark-theme"===this.primaryWorkspace.getTheme().getClassName()?(this.shadowColor="black",this.bgColor="#1e1e1e"):(this.shadowColor="grey",this.bgColor="#fff"),this.setMinimapCss()},e.prototype.setMinimapCss=function(){var t=this.minimapWorkspace.getInjectionDiv();this.closed?t.setAttribute("style","display: none;"):t.setAttribute("style","display: block;box-shadow: 2px 2px 10px ".concat(this.shadowColor,";")),t.parentElement.setAttribute("style","z-index: 2;\n          position: absolute;\n          width: ".concat(this.width,"px;\n          height: ").concat(this.height,"px;\n          top: ").concat(this.top,"px;\n          left: ").concat(this.left,"px;\n          /*box-shadow: 2px 2px 10px ").concat(this.shadowColor,";*/\n          display: inline-flex;\n          flex-direction: column;\n          /*background-color: ").concat(this.bgColor,";*/")),r.svgResize(this.minimapWorkspace)},e}(i(351).Minimap);e.PositionedMinimap=s},573:e=>{e.exports=t}},i={};function o(t){var n=i[t];if(void 0!==n)return n.exports;var r=i[t]={exports:{}};return e[t].call(r.exports,r,r.exports,o),r.exports}var n={};return(()=>{var t=n;Object.defineProperty(t,"__esModule",{value:!0}),t.PositionedMinimap=t.Minimap=void 0;var e=o(351);Object.defineProperty(t,"Minimap",{enumerable:!0,get:function(){return e.Minimap}});var i=o(153);Object.defineProperty(t,"PositionedMinimap",{enumerable:!0,get:function(){return i.PositionedMinimap}})})(),n})()));